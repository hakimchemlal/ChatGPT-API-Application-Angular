<div>
  <div class="card">
    <div class="card-body">
      <form [formGroup]="queryFormGroup" (ngSubmit)="handleAskGPT()">
        <div class="mb-3">
          <label for="" class="form-label font-monospace ">Query</label>
          <textarea formControlName="query" name="" id="" cols="30" rows="10" class="form-control"></textarea>
        </div>
        <button class="btn btn-success ">Ask Me</button>
      </form>
      <div *ngIf="response" class="alert alert-success">
        <pre>{{response | json}}</pre>
        <ul class="list-group">
          <li class="list-group-item" *ngFor="let choice of response.choices">
            <pre>{{choice.message.content}}</pre>
          </li>
        </ul>
      </div>
      <div *ngIf="error !== undefined" class="alert alert-success">
        <pre>{{error | json}}</pre>
      </div>
      <div class="card my-4">
        <div class="card-header">Conversations</div>
        <div class="card-body">
          <table class="table">
            <thead>
            <tr>
            <th>Role</th>
            <th>Content</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let message of messages">
              <td>{{message.role}}</td>
              <td>{{message.content}}</td>
            </tr>
            </tbody>
          </table>
        </div>

      </div>
    </div>
    <div class="card-footer">
      <div style="text-align: center">
        <p class="fst-italic">Un site vitrine créé avec <i class="bi bi-heart-fill red-heart" title="amour et passion"></i> par <a href="https://main--verdant-cassata-48de53.netlify.app/">CHEMLAL Abdelhakim</a></p>
      </div>
    </div>
  </div>
</div>

<div *ngIf="showLoader" class="mire-background">
  <div class="mire">
    <div class="loader loader-full-screen" ></div>
  </div>
</div>


